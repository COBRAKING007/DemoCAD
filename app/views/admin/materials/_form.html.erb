<%= form_with model: [:admin, material], class: "material-form", data: { controller: "image-preview" } do |form| %>
  <% if material.errors.any? %>
    <div class="form-errors">
      <h3><%= pluralize(material.errors.count, "error") %> prohibited this material from being saved:</h3>
      <ul>
        <% material.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <%= form.label :name, "Material Name", class: "form-label" %>
    <%= form.text_field :name, class: "form-input", placeholder: "Enter material name", required: true %>
  </div>

  <div class="form-group">
    <%= form.label :image, "Material Image", class: "form-label" %>
    <%= form.file_field :image, 
        class: "form-input", 
        accept: "image/*",
        data: { 
          action: "change->image-preview#preview",
          image_preview_target: "input"
        } %>
    
    <div class="image-preview-container" data-image-preview-target="container">
      <% if material.image.attached? %>
        <%= image_tag material.image, class: "image-preview", data: { image_preview_target: "preview" } %>
      <% end %>
    </div>
  </div>

  <div class="form-actions">
    <%= form.submit material.persisted? ? "Update Material" : "Create Material", class: "btn btn-primary" %>
    <%= link_to "Cancel", admin_dashboard_path, class: "btn btn-secondary" %>
  </div>
<% end %>
